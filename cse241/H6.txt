-- Question 1 --
SELECT YEAR, MONTH, DAY, (AMOUNT*PRICE) AS TOTAL, RANK() OVER (ORDER BY AMOUNT*PRICE DESC) AS SALE_RANK
FROM SALE
WHERE PROD_ID = 1
ORDER BY TOTAL DESC;

-- Question 2 --
SELECT YEAR, MONTH, DAY, SUM(AMOUNT*PRICE) AS TOTAL
FROM SALE
GROUP BY ROLLUP(YEAR, MONTH, DAY)
ORDER BY YEAR;

-- Question 3 --
3,926 Rows Selected

-- Question 4 --
SELECT YEAR, PROD_ID, SUM(AMOUNT*PRICE) AS TOTAL, RANK() OVER (PARTITION BY YEAR ORDER BY SUM(AMOUNT*PRICE) DESC) AS S_RANK
FROM SALE
GROUP BY YEAR, PROD_ID
ORDER BY YEAR, TOTAL DESC;

-- Question 5 --
SELECT YEAR, MONTH, AVG(SUM(AMOUNT*PRICE)) OVER (ORDER BY YEAR, MONTH ROWS 2 PRECEDING) AS AVERAGE
FROM SALE
WHERE PROD_ID = 2
AND AMOUNT != 0
GROUP BY YEAR, MONTH
ORDER BY YEAR, MONTH;

-- Question 6 --
group by rollup(a), rollup(b), rollup(c), rollup(d)